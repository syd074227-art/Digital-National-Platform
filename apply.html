<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام تفعيل الهوية - هيئة KR الرقمية</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ستايلك الأصلي الفاخر (تم اختصاره هنا للحفاظ على مساحة الكود، احتفظ بستايلك القديم كاملاً) */
        :root { --primary: #1e3a8a; --gold: #b8860b; --dark: #0f172a; --light: #f8fafc; }
        body { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); min-height: 100vh; color: var(--light); font-family: 'Segoe UI', sans-serif; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .container { width: 100%; max-width: 800px; background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(20px); border-radius: 30px; border: 1px solid rgba(255,255,255,0.1); overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .header { background: linear-gradient(135deg, #1e3a8a 0%, #0f172a 100%); padding: 40px; text-align: center; border-bottom: 2px solid var(--gold); }
        .content { padding: 40px; }
        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 10px; color: var(--gold); }
        input, select { width: 100%; padding: 15px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; color: white; outline: none; }
        .btn { width: 100%; padding: 20px; background: linear-gradient(135deg, #b8860b 0%, #ffd700 100%); color: #000; border: none; border-radius: 15px; font-weight: 700; cursor: pointer; margin-top: 20px; transition: 0.3s; }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(184,134,11,0.4); }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <i class="fas fa-id-card-alt" style="font-size: 50px; color: var(--gold);"></i>
            <h1 style="margin-top:15px;">نظام تفعيل الهوية الرقمي</h1>
            <p>هيئة KR الرقمية</p>
        </div>
        
        <div class="content" id="mainContent">
            <div class="input-group">
                <label><i class="fas fa-user"></i> الاسم الكامل</label>
                <input type="text" id="fullName" placeholder="أدخل اسمك الثلاثي">
            </div>
            
            <div class="input-group">
                <label><i class="fas fa-gamepad"></i> رقم الهوية في اللعبة (ID)</label>
                <input type="number" id="gameId" placeholder="أدخل الرقم التعريفي">
            </div>
            
            <div class="input-group">
                <label><i class="fas fa-briefcase"></i> اختيار القطاع</label>
                <select id="jobSector">
                    <option value="interior">وزارة الداخلية</option>
                    <option value="health">وزارة الصحة</option>
                    <option value="justice">وزارة العدل</option>
                    <option value="citizen">مواطن</option>
                </select>
            </div>

            <div class="input-group">
                <label><i class="fas fa-award"></i> المنصب / الرتبة</label>
                <input type="text" id="rankName" placeholder="مثال: جندي، طبيب، قاضي">
            </div>

            <button class="btn" onclick="submitApplication()">
                <i class="fas fa-paper-plane"></i> إرسال طلب التفعيل
            </button>
        </div>
    </div>

    <script>
        function submitApplication() {
            const name = document.getElementById('fullName').value;
            const id = document.getElementById('gameId').value;
            const sector = document.getElementById('jobSector').value;
            const rank = document.getElementById('rankName').value;

            if(!name || !id || !rank) {
                alert("أكمل البيانات أولاً!");
                return;
            }

            // البيانات بصيغة موحدة للوحة الإدارة
            const requestData = {
                id: 'KR-' + Date.now().toString().slice(-6),
                name: name,
                gameId: id,
                jobName: getSectorName(sector) + " - " + rank,
                status: 'pending',
                date: new Date().toLocaleDateString('ar-SA')
            };

            // الحفظ في المستودع الموحد
            let db = JSON.parse(localStorage.getItem('user_applications') || '[]');
            db.push(requestData);
            localStorage.setItem('user_applications', JSON.stringify(db));

            // تغيير واجهة الصفحة بعد النجاح
            document.getElementById('mainContent').innerHTML = `
                <div style="text-align:center; padding:40px;">
                    <i class="fas fa-check-circle" style="font-size:80px; color:#059669; margin-bottom:20px;"></i>
                    <h2 style="color:var(--gold);">تم إرسال طلبك بنجاح</h2>
                    <p style="margin-top:15px;">رقم الطلب: ${requestData.id}</p>
                    <p>سيتم مراجعة طلبك من قبل الإدارة فوراً.</p>
                </div>
            `;
        }

        function getSectorName(s) {
            const map = { interior: 'الداخلية', health: 'الصحة', justice: 'العدل', citizen: 'مواطن' };
            return map[s];
        }
    </script>
</body>
</html>
